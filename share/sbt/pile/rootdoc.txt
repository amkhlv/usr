This is my file server

Pay __ATTENTION__ to the value of `application.secret`

= Building this documentation =

{{{
sbt clean doc
}}}

= Files =

List of files:

 - `/etc/pile/application.conf` : the main configuration file, includes :
    - the secret key `application.secret` 
    - the URL of the site (at the tail of the file)
    - path to the users directory (at the tail)
    - path to the logging configurator (at the tail), which is:
 - `/etc/pile/log4j.properties` : logging configurator (an example can be found in the root of this project)
 - `/etc/systemd/system/amkhlv-pile.service` (if using systemd):
{{{
[Unit]
Description=file server

[Service]
ExecStart=/opt/pile/bin/pile  -Dconfig.file=/etc/pile/application.conf -Dhttp.port=29430 -Dhttp.address=127.0.0.1 -Dpidfile.path=/tmp/amkhlv-pile.pid
PIDFile=/tmp/amkhlv-pile.pid
User=www-data

[Install]
WantedBy=multi-user.target
}}}
 - `/opt/pile/` : the directory for binaries and jars
 - `/opt/pile/conf/logger.xml` : this file configures the logging 
 (unfortunately this one is impossible to configure in the `/etc/systemd/system/amkhlv-pile.service` because the option `-Dlogger.file` is broken; 
 there are two logs: one is mine, configured in `/etc/pile/log4j.properties`, 
 and another, built-in, is configured in `/opt/pile/conf/logger.xml`)
 - `/var/www/pile-users` : the user directory; contains :
    - `config.xml`
    - for every user :
       1. An entry in `config.xml` under the `<users>` tag, of the form:
          `<user name="aaa" hash="$2a$10$...."/>` where the hash value is obtained as follows: at the sbt prompt,
          say `console`, this will start the Scala console. At the Scala prompt: scala> controllers.Utils.mkpasswd
          (It will ask for the plaintext password, and then print the hash)
       2. A subdirectory `username/` (which is initially empty; thats where the files will be stored)
       3. A file `username.md` with some greeting

The folder `/var/www/pile-users/`  and everything in them should be owned by `www-data:www-data`,
while  `/opt/pile/bin/pile` and `/etc/pile` and everything in them should be owned by `root:root`.

= Building and installation =

== Building ==

{{{
sbt clean stage
}}}

== Installation ==

As root:

{{{
rsync -cav --delete target/universal/stage/  /opt/pile/
chown -R root:root /opt/pile
}}}

Then look inside `/opt/pile/conf/logger.xml` and see if it is OK. Then set up `/var/www/pile-users/` and `/etc/pile/` as described above.

